platform :ios, '13.0'

def flutter_root
  root = ENV['FLUTTER_ROOT']
  return root unless root.nil? || root.empty?

  # Try to get Flutter SDK root by calling `flutter --version --machine`
  require 'json'
  flutter_version_json = `flutter --version --machine`
  if $?.success?
    json = JSON.parse(flutter_version_json)
    return json['flutterRoot'] if json.key?('flutterRoot')
  end

  # Fallback
  '../flutter'
end

load File.join(flutter_root, 'packages', 'flutter_tools', 'bin', 'podhelper.rb')


# --- Your Runner target ---
target 'Runner' do
  use_frameworks!
  use_modular_headers!

  flutter_install_all_ios_pods File.dirname(File.realpath(__FILE__))
end